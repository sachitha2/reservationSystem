<!DOCTYPE html>
<html>
<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.6.9/angular.min.js"></script>
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
<!-- jQuery library -->
<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.4.1/jquery.min.js"></script>

<!-- Popper JS -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>

<!-- Latest compiled JavaScript -->
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.3.1/js/bootstrap.min.js"></script>




<body>

<div ng-app="myApp" ng-controller="myCtrl"> 
        <div class="jumbotron text-center">
            <h1>Reservation Sysytem</h1>
            
        </div>
        
        <div class="container" id="x">
                <div ng:include="template.url"></div>
                   
                     
                    
        </div>
    

</div>

<script>
var app = angular.module('myApp', []);
app.controller('myCtrl', function($scope, $http) {

    $scope.hall = {
        //bId:"",
        bknDate :"",
        purpose :"",
        payment :""
    }

    $scope.room = {
        //bId:"",
        aDate:"",
        dDate:"",
        sR:0,
        dR:0

    }
    $scope.customer ={
        fName:"",
        lName:"",
        nic:"",
        address:"",
        tel:"",
        email:""
    }


    $scope.bookingType = 0;
    $scope.bTypeHead = "";
    //0 for null
    //1 for room
    //2 for hall

    $scope.templates = [{
        name: 'Select Your Reservation Type',
        url: 'selectType.html'
    }, {
        name: 'customerForm.html',
        url: 'customerForm.html'
    },
    {
        name:'room',
        url:"room.html"
    },{
        name:"hall",
        url:"hall.html"
    },{
        name:"finish booking",
        url:"finishBooking.html"
    },{
        name:"my bookings",
        url:"myBookings.html"
    }
    ];

    
    $scope.defaultTemplate=function(){
        $scope.template = $scope.templates[0];
        //Set default booking type as null
        $scope.bookingType = 0;
        $scope.bTypeHead = "";
    }
    $scope.defaultTemplate();
    //Load my bookings
    $scope.loadMyBookingsPage = function(){
        $scope.template = $scope.templates[5];
    }

    //this is for room
    $scope.registerCustomerForRoom=function(){
        $scope.bookingType = 1;
        $scope.bTypeHead = "Room";
        $scope.template = $scope.templates[1];
    }
    //this is for hall
    $scope.registerCustomerForHall=function(){
        $scope.bookingType = 2;
        $scope.bTypeHead = "Hall";
        $scope.template = $scope.templates[1];
    }

    //Auto fill data
    //Autofill data for cutomer
    $scope.autoFillDataCustomer  = function(){
        $scope.fName = "First";
        $scope.lName = " Last";
        $scope.cNic = "123456789v";
        $scope.cAddress = "Address 12345";
        $scope.cPhone = "0710000000";
        $scope.cEmail = "mail@mail.com";
    }
    //Auto fill room data
    $scope.autoFillDataRoom = function(){
        $scope.arrive = "10/12/2019";
        $scope.depart = "20/12/2019";
        $scope.no_doub_rooms = 2;
        $scope.no_sin_rooms = 2;
    }

    $scope.autoFillDataHall = function(){
        $scope.booking_date = "10/12/2019";
        $scope.purpose = "Purpose";
        $scope.payment = 10000;
    }

    $scope.roomOrHall = function(){
        $scope.customer.fName = $scope.fName;
        $scope.customer.lName = $scope.lName;
        $scope.customer.nic   = $scope.cNic;
        $scope.customer.address = $scope.cAddress;
        $scope.customer.tel = $scope.cPhone;
        $scope.customer.email = $scope.cEmail;
        if($scope.bookingType == 1){
            //Room
            $scope.template = $scope.templates[2];
        }else if($scope.bookingType == 2){
            //Hall
            $scope.template = $scope.templates[3];
        }else{

        }
    }

    
    

    $scope.finishRoomBkng = function(){
        $scope.room.aDate = $scope.arrive;
        $scope.room.dDate = $scope.depart;
        $scope.room.sR = $scope.no_sin_rooms;
        $scope.room.dR = $scope.no_doub_rooms;

        
        $scope.template = $scope.templates[4];
        $scope.data = "Room Data";

    }
    $scope.finishHallBkng = function(){
        $scope.hall.bknDate = $scope.booking_date;
        $scope.hall.purpose = $scope.purpose;
        $scope.hall.payment = $scope.payment;

        $scope.template = $scope.templates[4];
        $scope.data = "Hall Data";
    }

    $scope.backDesideInFinish = function(){
        if($scope.bookingType == 1){
            //Room
            $scope.template = $scope.templates[2];
        }else if($scope.bookingType == 2){
            //Hall
            $scope.template = $scope.templates[3];
        }else{

        }

    }
    $scope.finish = function(){
        var book = {
            type : $scope.bookingType,
            hall :$scope.hall,
            room:$scope.room,
            customer:$scope.customer
        }

        // $scope.result = book;


        $http({
            method : "POST",
            data:JSON.stringify(book),
            url : "http://localhost:3000/booking/"
        }).then(function mySuccess(response) {
            $scope.data = response.data;
            
            }, function myError(response) {
            $scope.data = response.statusText;
        });
    }


    $scope.loadMyBookings = function(){
        
    }
});


</script>

</body>
</html>